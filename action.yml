name: "Host Ace Archive artifacts"
description: >
  This action is part of the Ace Archive project, and is used to host content
  submitted to Ace Archive.
inputs:
  path:
    description: >
      The path of the directory in the repository containing the artifact
      files.
    required: true
    default: "artifacts"
  mode:
    description: >
      The mode to operate in, either `tree` or `history`. In `tree` mode,
      artifact files are pulled from the working tree and their syntax is
      validated. In `history` mode, the entire commit history is traversed to
      pull each version of each artifact file, and syntax errors are ignored
      silently.
    required: true
    default: "tree"
  w3s-token:
    description: >
      The secret API token for Web3.Storage. If this is provided, all artifacts
      in the repository are uploaded to Web3.Storage.
    required: false
  ipfs-api:
    description: >
      The multiaddr of the API endpoint of the running IPFS node. This is
      required to upload artifacts to Web3.Storage.
    required: false
  pin-endpoint:
    description: >
      The URL of the IPFS pinning service API endpoint to use. If this is
      provided, all artifacts in the repository are pinned using this pinning
      service.
    required: false
  pin-token:
    description: >
      The bearer token for the configured IPFS pinning service. This is
      required to pin artifacts using an IPFS pinning service.
    required: false
outputs:
  artifacts:
    description: >
      A JSON document describing the artifacts in the repository.
  cids:
    description: >
      A deduplicated JSON array of the CIDs contained in artifacts in the repository.
runs:
  using: "docker"
  image: "Dockerfile"
  args:
    - "--action"
branding:
  icon: "archive"
  color: "purple"
